<div id="nav-chat-icon-container" style="position: relative; display: inline-block; cursor: pointer;">
    <i id="chat-icon" class="fa-regular fa-comments" style="font-size: 24px; color: #555;"></i>
    
    <span id="alarm-badge" style="
        display: none; 
        position: absolute; 
        top: -2px; 
        right: -2px; 
        width: 12px; 
        height: 12px; 
        background-color: #ff4d4d; 
        border: 2px solid white; 
        border-radius: 50%;
    "></span>
</div>

<script>
    const alarmSocket = new WebSocket(
        'ws://' + window.location.host + '/ws/notifications/'
    );

    alarmSocket.onmessage = function(e) {
        const data = JSON.parse(e.data);
        console.log("알람 수신:", data);

        if (data.action === "ACTIVATE_5MIN_ALARM") {
            // 1. 빨간 점(배지) 노출
            document.getElementById('alarm-badge').style.display = 'block';
            
            // 2. 아이콘 스타일 변경 (선택사항: 색깔을 진하게 하거나 아이콘 교체)
            const icon = document.getElementById('chat-icon');
            icon.classList.remove('fa-regular');
            icon.classList.add('fa-solid'); // 꽉 찬 아이콘으로 변경
            icon.style.color = '#2a52be';   // 테마 컬러로 변경
            
            // 3. 콘솔이나 간단한 토스트 메시지
            console.warn(data.message);
        }
    };

    // 아이콘 클릭 시 알람 해제 (프로토타입용)
    document.getElementById('nav-chat-icon-container').onclick = function() {
        document.getElementById('alarm-badge').style.display = 'none';
        const icon = document.getElementById('chat-icon');
        icon.classList.remove('fa-solid');
        icon.classList.add('fa-regular');
        icon.style.color = '#555';
    };
</script>